%% test_logger.m
% logger í•¨ìˆ˜ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸
% ì‘ì„±ì¼: 2025-10-15

fprintf('========================================\n');
fprintf('  logger í•¨ìˆ˜ í…ŒìŠ¤íŠ¸\n');
fprintf('========================================\n\n');

%% ê²½ë¡œ ì¶”ê°€
addpath('D:\project\HRë°ì´í„°\matlab\ìê°€ë¶ˆì†Œ_revised_refact');

%% í…ŒìŠ¤íŠ¸ 1: ê¸°ë³¸ ë¡œê·¸ ë ˆë²¨ í…ŒìŠ¤íŠ¸
fprintf('ã€í…ŒìŠ¤íŠ¸ 1ã€‘ ê¸°ë³¸ ë¡œê·¸ ë ˆë²¨ í…ŒìŠ¤íŠ¸\n');
fprintf('â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n');

logger('INFO', 'Test started');
logger('DEBUG', 'Debug message: variable x = %d', 42);
logger('WARNING', 'Warning: %s', 'This is a test warning');
logger('ERROR', 'Error occurred in function %s at line %d', 'testFunc', 123);

fprintf('âœ… ê¸°ë³¸ ë¡œê·¸ ë ˆë²¨ í…ŒìŠ¤íŠ¸ ì™„ë£Œ\n\n');

%% í…ŒìŠ¤íŠ¸ 2: í¬ë§·íŒ… í…ŒìŠ¤íŠ¸
fprintf('ã€í…ŒìŠ¤íŠ¸ 2ã€‘ í¬ë§·íŒ… í…ŒìŠ¤íŠ¸\n');
fprintf('â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n');

logger('INFO', 'ë°ì´í„° ë¡œë“œ ì™„ë£Œ: %dëª…', 158);
logger('INFO', 'ì—­ëŸ‰ê²€ì‚¬ ë°ì´í„°: %dëª…, ì—­ëŸ‰ ìˆ˜: %dê°œ', 130, 25);
logger('INFO', 'Bootstrap ì§„í–‰: %.1f%% ì™„ë£Œ', 75.5);

fprintf('âœ… í¬ë§·íŒ… í…ŒìŠ¤íŠ¸ ì™„ë£Œ\n\n');

%% í…ŒìŠ¤íŠ¸ 3: ì—°ì† ë¡œê·¸ í…ŒìŠ¤íŠ¸
fprintf('ã€í…ŒìŠ¤íŠ¸ 3ã€‘ ì—°ì† ë¡œê·¸ í…ŒìŠ¤íŠ¸ (10íšŒ)\n');
fprintf('â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n');

for i = 1:10
    logger('DEBUG', 'Iteration %d/%d', i, 10);
end

fprintf('âœ… ì—°ì† ë¡œê·¸ í…ŒìŠ¤íŠ¸ ì™„ë£Œ\n\n');

%% í…ŒìŠ¤íŠ¸ 4: ì˜¤ë¥˜ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸
fprintf('ã€í…ŒìŠ¤íŠ¸ 4ã€‘ ì˜¤ë¥˜ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸\n');
fprintf('â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n');

% ì˜ëª»ëœ ë ˆë²¨ (ìë™ìœ¼ë¡œ INFOë¡œ ë³€í™˜)
logger('INVALID_LEVEL', 'This should be treated as INFO');

% ì¸ìˆ˜ ëˆ„ë½ (ê²½ê³ ë§Œ ì¶œë ¥)
try
    logger('INFO');
    fprintf('âŒ ì¸ìˆ˜ ëˆ„ë½ ì‹œ ê²½ê³ ë¥¼ ì¶œë ¥í•´ì•¼ í•¨\n');
catch
    fprintf('âœ… ì¸ìˆ˜ ëˆ„ë½ ì˜¤ë¥˜ ì²˜ë¦¬ ì™„ë£Œ\n');
end

% í¬ë§· ì˜¤ë¥˜ (ì›ë³¸ ë©”ì‹œì§€ ì‚¬ìš©)
logger('INFO', 'Value: %d %d', 42);  % ì¸ìˆ˜ ë¶€ì¡±

fprintf('âœ… ì˜¤ë¥˜ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸ ì™„ë£Œ\n\n');

%% í…ŒìŠ¤íŠ¸ 5: ë¡œê·¸ íŒŒì¼ í™•ì¸
fprintf('ã€í…ŒìŠ¤íŠ¸ 5ã€‘ ë¡œê·¸ íŒŒì¼ í™•ì¸\n');
fprintf('â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n');

log_dir = 'D:\project\HRë°ì´í„°\matlab\ìê°€ë¶ˆì†Œ_revised_refact\logs';
if exist(log_dir, 'dir')
    log_files = dir(fullfile(log_dir, 'analysis_log_*.txt'));
    if ~isempty(log_files)
        latest_log = log_files(end);
        fprintf('âœ… ë¡œê·¸ íŒŒì¼ ìƒì„± í™•ì¸\n');
        fprintf('  íŒŒì¼ëª…: %s\n', latest_log.name);
        fprintf('  í¬ê¸°: %d bytes\n', latest_log.bytes);
        fprintf('  ê²½ë¡œ: %s\n', fullfile(log_dir, latest_log.name));

        % ë¡œê·¸ íŒŒì¼ ë‚´ìš© ì½ê¸° (ë§ˆì§€ë§‰ 5ì¤„)
        try
            log_path = fullfile(log_dir, latest_log.name);
            fid = fopen(log_path, 'r', 'n', 'UTF-8');
            if fid > 0
                content = fread(fid, '*char')';
                fclose(fid);

                lines = strsplit(content, '\n');
                fprintf('\n  ë¡œê·¸ íŒŒì¼ ë§ˆì§€ë§‰ 5ì¤„:\n');
                fprintf('  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n');
                start_idx = max(1, length(lines) - 5);
                for i = start_idx:length(lines)
                    if ~isempty(lines{i})
                        fprintf('  %s\n', lines{i});
                    end
                end
            end
        catch ME
            fprintf('  âš ï¸  ë¡œê·¸ íŒŒì¼ ì½ê¸° ì‹¤íŒ¨: %s\n', ME.message);
        end
    else
        fprintf('âŒ ë¡œê·¸ íŒŒì¼ì´ ìƒì„±ë˜ì§€ ì•ŠìŒ\n');
    end
else
    fprintf('âŒ ë¡œê·¸ ë””ë ‰í† ë¦¬ê°€ ìƒì„±ë˜ì§€ ì•ŠìŒ\n');
end

%% í…ŒìŠ¤íŠ¸ 6: ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
fprintf('\nã€í…ŒìŠ¤íŠ¸ 6ã€‘ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ (1000íšŒ ë¡œê·¸)\n');
fprintf('â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n');

tic;
for i = 1:1000
    logger('DEBUG', 'Performance test: %d', i);
end
elapsed = toc;

fprintf('âœ… 1000íšŒ ë¡œê·¸ ì‘ì„± ì‹œê°„: %.3fì´ˆ\n', elapsed);
fprintf('  í‰ê·  ì†ë„: %.3f ms/log\n', elapsed * 1000 / 1000);

if elapsed < 1.0
    fprintf('  âœ… ì„±ëŠ¥ ì–‘í˜¸ (< 1ì´ˆ)\n');
elseif elapsed < 2.0
    fprintf('  âš ï¸  ì„±ëŠ¥ ë³´í†µ (< 2ì´ˆ)\n');
else
    fprintf('  âŒ ì„±ëŠ¥ ì €í•˜ (> 2ì´ˆ)\n');
end

%% ìµœì¢… ê²°ê³¼
fprintf('\n========================================\n');
fprintf('  ğŸ‰ ëª¨ë“  logger í…ŒìŠ¤íŠ¸ ì™„ë£Œ!\n');
fprintf('========================================\n\n');

fprintf('ã€ê²°ê³¼ ìš”ì•½ã€‘\n');
fprintf('â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n');
fprintf('âœ… ê¸°ë³¸ ë¡œê·¸ ë ˆë²¨: INFO, DEBUG, WARNING, ERROR\n');
fprintf('âœ… ë©”ì‹œì§€ í¬ë§·íŒ…: sprintf í˜•ì‹ ì§€ì›\n');
fprintf('âœ… ì—°ì† ë¡œê·¸: ì •ìƒ ì‘ë™\n');
fprintf('âœ… ì˜¤ë¥˜ ì²˜ë¦¬: ë¶„ì„ ì¤‘ë‹¨í•˜ì§€ ì•ŠìŒ\n');
fprintf('âœ… íŒŒì¼ ì €ì¥: UTF-8 ì¸ì½”ë”©\n');
fprintf('âœ… ì„±ëŠ¥: %.3f ms/log\n', elapsed * 1000 / 1000);
fprintf('â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n');
