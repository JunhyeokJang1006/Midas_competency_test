# 역량 기반 인재유형 예측 분석 시스템

## 📋 분석 개요

### 파일명
`competency_statistical_analysis_logistic_revised_talent.m`

### 분석 목적
입사자의 역량검사 데이터를 활용하여 **인재유형을 예측**하고, 고성과자와 저성과자를 구분하는 **핵심 역량**을 식별하는 통합 분석 시스템

---

## 🎯 핵심 연구 질문

1. **어떤 역량이 고성과자와 저성과자를 효과적으로 구분하는가?**
2. **역량 가중치를 어떻게 설정해야 예측 성능이 최대화되는가?**
3. **단순 평균 방식 vs 로지스틱 가중치 방식 중 어느 것이 더 효과적인가?**
4. **인구통계학적 변수(나이, 성별)가 역량-성과 관계에 미치는 영향은?**

---

## 📊 인재유형 분류 체계

### 7가지 인재유형 및 성과 순위
| 인재유형 | 성과 CODE | 분류 |
|---------|----------|------|
| 자연성 | 8 | 최상위 고성과자 |
| 성실한 가연성 | 7 | 고성과자 |
| 유익한 불연성 | 6 | 고성과자 |
| 유능한 불연성 | 5 | **분석 제외** (중간 그룹) |
| 게으른 가연성 | 4 | 저성과자 |
| 무능한 불연성 | 3 | 저성과자 |
| 소화성 | 1 | 최하위 저성과자 |
| 위장형 소화성 | - | **분석 제외** |

### 극단 그룹 비교 방식
- **`extreme` 모드**: 가장 확실한 케이스만 비교
  - 고성과: 자연성, 성실한 가연성
  - 저성과: 무능한 불연성, 소화성
  - 장점: 명확한 구분, 높은 효과 크기
  - 단점: 표본 수 제한, 일반화 제약

- **`all` 모드**: 모든 고/저성과자 비교 (기본값)
  - 고성과: 자연성, 성실한 가연성, 유익한 불연성
  - 저성과: 게으른 가연성, 무능한 불연성, 소화성
  - 장점: 충분한 표본 수, 높은 일반화 가능성
  - 단점: 효과 크기 감소 가능성

---

## 🔬 분석 방법론

### PART 1: 데이터 전처리 및 품질 관리

#### 1.1 신뢰가능성 필터링
- 역량검사 데이터의 **신뢰불가** 응답자 제외
- 불성실 응답 등으로 인한 노이즈 제거

#### 1.2 개발자 데이터 필터링
- 개발자/비개발자 구분 옵션 제공
- 3가지 모드: 전체 사용, 개발자 제외, 개발자만 분석
- 기본값: 전체 데이터 사용

#### 1.3 이상치 탐지 및 제거 (STEP 4.8)
- **IQR 방법**: 사분위수 범위 기반 (배수: 1.5)
- **Z-score 방법**: 표준편차 기반 (임계값: 3)
- **백분위수 방법**: 상하위 5% 제거
- 역량별 이상치 개수 보고 및 제거 결과 시각화

#### 1.4 Cut-off 효과 분석
역량 검사 데이터의 분포 왜곡 탐지:
- **Floor Effect**: 바닥 효과 (최소값 집중)
- **Ceiling Effect**: 천장 효과 (최대값 집중)
- **Lower/Upper Truncation**: 분포 절단
- **Range Restriction**: 범위 제한 (이론적 범위의 50% 미만 사용)
- 정규성 검정 (Lilliefors, Jarque-Bera)

#### 1.5 결측치 처리
- 결측 비율 20% 이상인 개인 제외
- 완전 케이스 분석 (complete case analysis)

---

### PART 2: 역량 프로파일 시각화

#### 2.1 인재유형별 레이더 차트
- **통일된 스케일** 사용 (모든 차트 동일 범위)
- 10 단위 확장 (가독성 향상)
- 주요 12개 역량 선정 (분산 기준)
- 개별 Figure 생성 (인재유형별)
- Baseline 옵션:
  - **단순평균**: 전체 평균 (기본)
  - **가중평균**: 샘플 수 기반 가중치 적용

#### 2.2 성별별 역량 프로파일 비교
- 남성/여성 그룹별 평균 역량 프로파일
- Cohen's d 효과 크기 계산
- Bonferroni 다중비교 보정
- 유의미한 성별 차이 역량 식별

---

### PART 3: 고도화된 상관 기반 가중치 분석

#### 3.1 성과점수 기반 상관분석 (STEP 7-8)
- **Spearman 상관계수** 사용 (순위 기반)
- 역량-성과 순위 상관관계 계산
- 상위/하위 25% 그룹 비교
- Cohen's d 효과 크기 측정

#### 3.2 가중치 계산
```
가중치 = (양의 상관계수) / (전체 양의 상관계수 합) × 100
```
- 음의 상관은 0으로 처리
- 상위 10개 예측 역량 추출

#### 3.3 마할라노비스 거리 분석 (STEP 8-1)
- 7개 인재유형 간 거리 매트릭스 계산
- Pooled 공분산 행렬 사용
- 거리 히트맵 시각화
- 유형 간 유사도/차별성 평가

---

### PART 4: Logistic Regression 기반 예측 모델

#### 4.1 데이터 준비 (STEP 9)
- 이진분류: 고성과자(1) vs 저성과자(0)
- 클래스 불균형 처리:
  - **Inverse Frequency Weighting** 적용
  - 샘플 가중치 계산
- 비용 행렬 정의:
  - 저성과자→고성과자 오분류 비용 **1.5배**

#### 4.2 인구통계학적 변수 통제 (STEP 9.5)
- **나이 효과 분석**:
  - 나이-성과 Spearman 상관계수
  - 유의미한 경우(|r| > 0.3) 모델에 포함
- **성별 효과 분석**:
  - 성별별 성과 차이 t-test
  - 유의미한 경우(p < 0.05) 모델에 포함

#### 4.3 하이퍼파라미터 튜닝 (STEP 10)
- **Ridge 정규화** 사용
- Lambda 탐색 범위: `logspace(-4, 2, 30)`
- 5-Fold 교차검증
- 평가 지표: 평균 손실 (Classification Loss)
- 최적 Lambda 선택 및 시각화

#### 4.4 최종 모델 학습 (STEP 11)
```matlab
fitclinear(...
    'Learner', 'logistic',
    'Cost', cost_matrix,
    'Weights', sample_weights,
    'Regularization', 'ridge',
    'Lambda', optimal_lambda)
```

#### 4.5 모델 평가 (STEP 12-15)
- **ROC/AUC 분석**:
  - 곡선 시각화
  - AUC 값 계산 (0~1, 높을수록 좋음)
- **혼동 행렬 (Confusion Matrix)**:
  - TP, TN, FP, FN 분해
  - 정확도, 정밀도, 재현율, F1 계산
- **개별 예측**:
  - 참가자별 실제 vs 예측 비교
  - 오분류 케이스 분석

---

### PART 5: 통계적 검증 시스템

#### 5.1 Bootstrap 안정성 검증 (STEP 16)
- **5000회 재샘플링**
- 역량별 가중치 분포 분석
- 평가 지표:
  - **평균 가중치**, **표준편차**, **95% CI**
  - **변동계수(CV)**: 안정성 지표
  - **순위 확률**: Top 3/Top 5 진입 확률
- 안정성 분류:
  - 매우 안정적: CV < 0.3 & Top3 > 70%
  - 불안정: CV > 0.5 | Top5 < 30%
- 시각화:
  - Boxplot (가중치 분포)
  - 히트맵 (순위 확률)

#### 5.2 극단 그룹 t-test 비교 (STEP 17)
- 고성과자 vs 저성과자 역량 비교
- 역량별 통계:
  - 평균, 표준편차
  - t-통계량, p-value
  - **Cohen's d** (효과 크기)
- 효과 크기 해석:
  - |d| < 0.2: 무시
  - 0.2 ≤ |d| < 0.5: 작음
  - 0.5 ≤ |d| < 0.8: 중간
  - |d| ≥ 0.8: 큼
- Bonferroni 다중비교 보정
- 핵심 차별화 역량 식별 (p<0.05 & |d|>0.5)

#### 5.3 퍼뮤테이션 테스트 (STEP 22.5)
- **F1 스코어 통계적 유의성 검증**
- 5000회 무작위 셔플링
- 캐싱 시스템 (`.mat` 파일 저장)
- Cohen's d 효과 크기 측정
- p-value 계산: `(1 + 더 좋은 경우) / (1 + 총 시행)`

---

### PART 6: 통합 가중치 분석 및 예측 검증

#### 6.1 4가지 가중치 방법론 비교 (STEP 19)
1. **상관 기반 가중치**
   - Spearman 상관계수 기반
   - 양의 상관만 사용

2. **Logistic 기반 가중치**
   - 회귀 계수 기반
   - Cost-sensitive 학습 반영

3. **t-test 기반 가중치**
   - 극단 그룹 비교 효과 크기
   - Cohen's d 기반

4. **통합 가중치 (Ensemble)**
   - 3가지 방법의 평균
   - 앙상블 효과

#### 6.2 예측 성능 비교 (STEP 20)
- 5-Fold 교차검증
- 평가 지표:
  - **정확도 (Accuracy)**
  - **F1 스코어**
  - **AUC**
- 최고 성능 방법론 선정
- 통계적 유의성 검증 (퍼뮤테이션)

#### 6.3 핵심 역량 추출 (STEP 21)
- 통합 가중치 기준 상위 역량
- 안정성 평가 (Bootstrap CV)
- 통계적 유의성 (t-test p-value)
- 효과 크기 (Cohen's d)

---

### PART 7: 실무 활용 분석

#### 7.1 로지스틱 가중치 vs 단순 평균 비교
**Top-K 정확도 분석**:
- 상위 10%, 20%, 30%, 50% 선발 시나리오
- 고성과자 비율 비교
- 개선율 계산 (%p, %)

**Lift Score 분석**:
- 랜덤 선발 대비 효과
- Lift = (모델 정확도) / (전체 고성과자 비율)
- Lift > 1: 모델이 랜덤보다 우수

**실제 채용 시뮬레이션**:
- 100명 지원자 중 10명 선발
- 1000회 Monte Carlo 시뮬레이션
- 3가지 방법 비교:
  1. 랜덤 선발
  2. 단순 평균
  3. 로지스틱 가중치
- 평균 고성과자 수 및 표준편차

**ROI 계산**:
- AUC 비교
- 개선 효과 정량화

---

## 📁 출력 결과물

### 1. 시각화 파일 (.png)
- 인재유형별 레이더 차트 (7개)
- 상관분석 결과 그래프
- Bootstrap 분포 및 순위 히트맵
- 극단 그룹 t-test 결과 (효과 크기, p-value)
- ROC 곡선
- 성별 역량 비교 (레이더, 막대그래프)
- 성과 비교 그래프 (Top-K, Lift, 시뮬레이션)

### 2. 데이터 파일 (.mat)
- `trained_logitboost_model.mat`: 학습된 모델
- `competency_weights.mat`: 역량 가중치 및 검증 결과
- `integrated_analysis_results.mat`: 통합 분석 결과
- `permutation_test_results.mat`: 퍼뮤테이션 캐시
- `performance_comparison_results.mat`: 성과 비교 데이터

### 3. 종합 보고서 (.xlsx)
총 8~18개 시트 포함:
1. **분석 요약**: 전체 결과 개요
2. **인재유형 분석**: 유형별 통계
3. **역량 가중치**: 4가지 방법론 비교
4. **예측 성능**: 교차검증 결과
5. **개별 예측**: 참가자별 예측값
6. **상관분석 결과**: 역량-성과 상관
7. **Bootstrap 검증**: 안정성 분석
8. **극단그룹 비교**: t-test 결과
9. **핵심 역량**: 최종 선정 역량
10. **퍼뮤테이션 검증**: 통계적 유의성
11. **Range 분석**: 역량별 분포 특성
12. **Cut-off 분석**: 분포 왜곡 탐지
13. **인구통계 분석**: 나이/성별 효과
14. **성별 분석 요약**: 성별 차이 종합
15. **성별 역량 차이**: 역량별 성별 비교

---

## 🔑 핵심 특징 및 혁신점

### 1. 다층적 검증 시스템
- Bootstrap (재샘플링)
- 퍼뮤테이션 (무작위화)
- 교차검증 (일반화 성능)
- t-test (통계적 유의성)

### 2. 견고한 데이터 품질 관리
- 신뢰가능성 필터링
- 이상치 탐지 및 제거
- Cut-off 효과 분석
- 결측치 처리

### 3. 인구통계학적 변수 통제
- 나이, 성별 효과 분석
- 편향 제거
- 공정성 평가

### 4. 실무 적용성
- Top-K 정확도 분석
- Lift Score 계산
- 채용 시뮬레이션
- ROI 정량화

### 5. 파일 관리 시스템
- 백업 자동화
- 타임스탬프 옵션
- 버전 관리

---

## ⚙️ 주요 설정 옵션

### config 구조체
```matlab
config.extreme_group_method = 'all';  % 'extreme' 또는 'all'
config.baseline_type = 'weighted';     % 'simple' 또는 'weighted'
config.use_saved_model = false;        % 모델 재사용 여부
config.force_recalc_permutation = false;  % 퍼뮤테이션 재계산
config.create_backup = true;           % 백업 폴더 생성
config.use_timestamp = false;          % 타임스탬프 사용
config.developer_filter = 'all';       % 개발자 필터링
```

### 이상치 제거 설정
```matlab
config.outlier_removal.enabled = true;
config.outlier_removal.method = 'none';  % 'iqr', 'zscore', 'percentile', 'none'
config.outlier_removal.iqr_multiplier = 1.5;
config.outlier_removal.zscore_threshold = 3;
config.outlier_removal.percentile_bounds = [5, 95];
```

---

## 📈 성과 지표 해석 가이드

### 1. 정확도 (Accuracy)
```
정확도 = (TP + TN) / (TP + TN + FP + FN)
```
- 전체 예측 중 맞춘 비율
- **주의**: 클래스 불균형 시 왜곡 가능

### 2. 정밀도 (Precision)
```
정밀도 = TP / (TP + FP)
```
- 고성과자로 예측한 것 중 실제 고성과자 비율
- **채용 관점**: 선발 정확성

### 3. 재현율 (Recall)
```
재현율 = TP / (TP + FN)
```
- 실제 고성과자 중 찾아낸 비율
- **채용 관점**: 인재 발굴율

### 4. F1 스코어
```
F1 = 2 × (정밀도 × 재현율) / (정밀도 + 재현율)
```
- 정밀도와 재현율의 조화평균
- **균형 지표**

### 5. AUC (Area Under ROC Curve)
- 0.5: 랜덤 수준
- 0.7~0.8: 양호
- 0.8~0.9: 우수
- 0.9 이상: 매우 우수

### 6. Lift Score
```
Lift = (모델 Top-K 정확도) / (전체 고성과자 비율)
```
- Lift = 2: 랜덤 대비 2배 효과
- **실무 가치 지표**

---

## 🎓 학술적 엄밀성

### 1. 다중비교 보정
- **Bonferroni 보정**: α = 0.05 / (비교 횟수)
- 제1종 오류 통제

### 2. 효과 크기 (Effect Size)
- **Cohen's d**: 실질적 의미 평가
- p-value의 한계 보완

### 3. 재현성 (Reproducibility)
- `rng(42, 'twister')`: 난수 시드 고정
- 결과 재현 가능

### 4. 정규화 (Regularization)
- Ridge (L2): 과적합 방지
- Lambda 튜닝: 일반화 성능 향상

---

## 💡 실무 활용 시나리오

### 시나리오 1: 신입 채용
- 역량검사 실시
- 로지스틱 가중치 점수 계산
- 상위 20% 선발
- **기대 효과**: 단순 평균 대비 10~20% 고성과자 비율 증가

### 시나리오 2: 역량 개발
- 개인별 핵심 역량 식별
- 부족한 역량 집중 개발
- 성장 경로 설계

### 시나리오 3: 조직 진단
- 인재유형 분포 분석
- 조직 건강도 평가
- 채용/육성 전략 수립

---

## ⚠️ 주의사항 및 제약

### 1. 데이터 품질 의존성
- 역량검사의 타당도/신뢰도 중요
- 신뢰불가 응답 제외 필수

### 2. 표본 크기
- 최소 100명 이상 권장
- 인재유형별 최소 5명 이상 필요

### 3. 외부 타당도
- 조직 특성에 따라 결과 상이 가능
- 정기적 재분석 필요

### 4. 윤리적 고려
- 역량검사 결과의 단독 사용 지양
- 다면적 평가와 병행

---

## 🔄 후속 분석 제안

1. **시계열 분석**: 입사 후 성과 추적
2. **외부 검증**: 타 조직 데이터 적용
3. **딥러닝 모델**: 비선형 관계 탐색
4. **조직 네트워크 분석**: 인재유형 간 상호작용

---

## 📚 참고 문헌

- Cohen, J. (1988). Statistical Power Analysis for the Behavioral Sciences.
- Hastie, T., Tibshirani, R., & Friedman, J. (2009). The Elements of Statistical Learning.
- Efron, B., & Tibshirani, R. J. (1994). An Introduction to the Bootstrap.

---

**작성일**: 2025년
**분석 도구**: MATLAB R2018b 이상
**필수 Toolbox**: Statistics and Machine Learning Toolbox
